# OpenGov Monitor - Hourly data sync from Subsquare
# Runs every hour at minute 0
# Security: Runs as node user (non-root, UID 1000) for defense-in-depth
# Log rotation: Truncate log if over 10MB to prevent disk fill (basic rotation)

0 * * * * node /bin/sh -c 'LOG=/data/opengov-sync.log; [ -f "$LOG" ] && [ $(stat -c%s "$LOG" 2>/dev/null || echo 0) -gt 10485760 ] && : > "$LOG"; cd /app/src/backend && /app/src/backend/.venv/bin/python scripts/run_sqlite.py --db /data/polkadot.db >> "$LOG" 2>&1'
